---
test_name: Endpoints _ 1. Add New User

includes:
  - !include includes.yaml

strict:
  - json:off

stages:
  - name: Add new user

    request:
      url: http://{host:s}:{port:d}/api/users
      follow_redirects: true
      method: POST
      json:
        username: "testUser123"

    response:
      status_code: [200, 201]
      save:
        json:
          user_id: id


  - name: Delete the user

    request:
      url: http://{host:s}:{port:d}/api/user/{user_id}/
      follow_redirects: true
      method: DELETE
      timeout: 1.0

    response:
      status_code: [200, 201]
      json:
        status: 0
        message: "User deleted"

---
test_name: Endpoints _ 2. Fetch New User

includes:
  - !include includes.yaml

strict:
  - json:off

stages:
  - name: Add new User

    request:
      url: http://{host:s}:{port:d}/api/users
      follow_redirects: true
      method: POST
      json:
        username: "testUser124"

    response:
      status_code: [200, 201]
      save:
        json:
          user_id: id

  - name: Fetch new user

    request:
      url: http://{host:s}:{port:d}/api/user/{user_id}/
      follow_redirects: true
      method: GET
      timeout: 1.0

    response:
      status_code: 200
      json:
        username: "testUser124"

  - name: Delete the user

    request:
      url: http://{host:s}:{port:d}/api/user/{user_id}/
      follow_redirects: true
      method: DELETE
      timeout: 1.0

    response:
      status_code: [200, 201]
      json:
        status: 0
        message: "User deleted"

---
test_name: Endpoints _ 3. Update user

includes:
  - !include includes.yaml

strict:
  - json:off

stages:
  - name: Add new user

    request:
      url: http://{host:s}:{port:d}/api/users
      follow_redirects: true
      method: POST
      json:
        username: "testUser128"

    response:
      status_code: [200, 201]
      save:
        json:
          user_id: id

  - name: Update user

    request:
      url: http://{host:s}:{port:d}/api/user/{user_id}/
      follow_redirects: true
      method: PUT
      json:
        username: "testUser128Updated"
        password: "1125"
      timeout: 1.0

    response:
      status_code: [200, 201]
      json:
        status: 0
        message: "User updated"

  - name: Retrieve the updated user

    request:
      url: http://{host:s}:{port:d}/api/user/{user_id}/
      follow_redirects: true
      method: GET
      timeout: 1.0

    response:
      status_code: 200
      json:
        username: "testUser128Updated"

  - name: Delete the user

    request:
      url: http://{host:s}:{port:d}/api/user/{user_id}/
      follow_redirects: true
      method: DELETE
      timeout: 1.0

    response:
      status_code: [200, 201]
      json:
        status: 0
        message: "User deleted"

---
test_name: Endpoints _ 4. Modify user

includes:
  - !include includes.yaml

strict:
  - json:off

stages:
  - name: Add new user

    request:
      url: http://{host:s}:{port:d}/api/users
      follow_redirects: true
      method: POST
      json:
        username: "testUser126"

    response:
      status_code: [200, 201]
      save:
        json:
          user_id: id

  - name: Modify user

    request:
      url: http://{host:s}:{port:d}/api/user/{user_id}/
      follow_redirects: true
      method: PATCH
      json:
        username: "testUser126Modified"
      timeout: 1.0

    response:
      status_code: [200, 201]
      json:
        status: 0
        message: "User modified"

  - name: Retrieve the modified user

    request:
      url: http://{host:s}:{port:d}/api/user/{user_id}/
      follow_redirects: true
      method: GET
      timeout: 1.0

    response:
      status_code: 200
      json:
        username: "testUser126Modified"


  - name: Delete the user

    request:
      url: http://{host:s}:{port:d}/api/user/{user_id}/
      follow_redirects: true
      method: DELETE
      timeout: 1.0

    response:
      status_code: [200, 201]
      json:
        status: 0
        message: "User deleted"

---
test_name: Endpoints _ 5. Delete user

includes:
  - !include includes.yaml

strict:
  - json:off

stages:
  - name: Add new user

    request:
      url: http://{host:s}:{port:d}/api/users
      follow_redirects: true
      method: POST
      json:
        username: "testUser127"

    response:
      status_code: [200, 201]
      save:
        json:
          user_id: id

  - name: Delete the user

    request:
      url: http://{host:s}:{port:d}/api/user/{user_id}/
      follow_redirects: true
      method: DELETE
      timeout: 1.0

    response:
      status_code: [200, 201]
      json:
        status: 0
        message: "User deleted"

  - name: Retrieve the deleted user

    request:
      url: http://{host:s}:{port:d}/api/user/{user_id}/
      follow_redirects: true
      method: GET
      timeout: 1.0

    response:
      status_code: [404]
















# ---
# test_name: Endpoints _ 6. Check Total Number of Users

# includes:
#   - !include includes.yaml

# strict:
#   - json:off

# stages:
#   - name: Add new user

#     request:
#       url: http://{host:s}:{port:d}/users
#       follow_redirects: true
#       method: POST
#       json:
#         username: "testUser123"

#     response:
#       status_code: [200, 201]
#       save:
#         json:
#           user_id: id

#   - name: Check total number of users

#     request:
#       url: http://{host:s}:{port:d}/users
#       follow_redirects: true
#       method: GET
#       timeout: 1.0

#     response:
#       status_code: 200
#       verify_response_with:
#         function: testing_utils:at_least_one_set

#   - name: Delete the set

#     request:
#       url: http://{host:s}:{port:d}/users/{user_id}
#       follow_redirects: true
#       method: DELETE
#       timeout: 1.0

#     response:
#       status_code: [200, 201]
#       json:
#         status: 0
#         message: "User deleted"
# ---
# test_name: Endpoints _ 7. Add New Program

# includes:
#   - !include includes.yaml

# strict:
#   - json:off

# stages:
#   - name: Add new Programs

#     request:
#       url: http://{host:s}:{port:d}/api/programs
#       follow_redirects: true
#       method: POST
#       json:
#         name: "Test program"
#         description: "Test description"
#         date: "Test date"

#     response:
#       status_code: [200, 201]
#       save:
#         json:
#           program_id: id


#   - name: Delete the program

#     request:
#       url: http://{host:s}:{port:d}/api/program/{program_id}/
#       follow_redirects: true
#       method: DELETE
#       timeout: 1.0

#     response:
#       status_code: [200, 201]
#       json:
#         status: 0
#         message: "program deleted"

# ---
# test_name: Endpoints _ 8. Fetch New Program

# includes:
#   - !include includes.yaml

# strict:
#   - json:off

# stages:
#   - name: Add new Program

#     request:
#       url: http://{host:s}:{port:d}/api/programs
#       follow_redirects: true
#       method: POST
#       json:
#         name: "Test program"
#         description: "Test description"
#         date: "Test date"
#     response:
#       status_code: [200, 201]
#       save:
#         json:
#           program_id: id

#   - name: Fetch new Program

#     request:
#       url: http://{host:s}:{port:d}/api/program/{program_id}/
#       follow_redirects: true
#       method: GET
#       timeout: 1.0

#     response:
#       status_code: 200
#       json:
#         name: "Test program"
#         description: "Test description"
#         date: "Test date"
#   - name: Delete the program

#     request:
#       url: http://{host:s}:{port:d}/api/program/{program_id}/
#       follow_redirects: true
#       method: DELETE
#       timeout: 1.0

#     response:
#       status_code: [200, 201]
#       json:
#         status: 0
#         message: "program deleted"

# ---
# test_name: Endpoints _ 9. Update program

# includes:
#   - !include includes.yaml

# strict:
#   - json:off

# stages:
#   - name: Add new program

#     request:
#       url: http://{host:s}:{port:d}/api/programs
#       follow_redirects: true
#       method: POST
#       json:
#         name: "Test program"
#         description: "Test description"
#         date: "Test date"
#     response:
#       status_code: [200, 201]
#       save:
#         json:
#           program_id: id

#   - name: Update program

#     request:
#       url: http://{host:s}:{port:d}/api/program/{program_id}/
#       follow_redirects: true
#       method: PUT
#       json:
#         name: "Updated test program"
#         description: "Updated Test description"
#         date: "Updated Test date"
#       timeout: 1.0

#     response:
#       status_code: [200, 201]
#       json:
#         status: 0
#         message: "program updated"

#   - name: Retrieve the updated program

#     request:
#       url: http://{host:s}:{port:d}/api/program/{program_id}/
#       follow_redirects: true
#       method: GET
#       timeout: 1.0

#     response:
#       status_code: 200
#       json:
#         name: "Updated test program"
#         description: "Updated Test description"
#         date: "Updated Test date"

#   - name: Delete the program

#     request:
#       url: http://{host:s}:{port:d}/api/program/{program_id}/
#       follow_redirects: true
#       method: DELETE
#       timeout: 1.0

#     response:
#       status_code: [200, 201]
#       json:
#         status: 0
#         message: "program deleted"

# ---
# test_name: Endpoints _ 10. Modify program

# includes:
#   - !include includes.yaml

# strict:
#   - json:off

# stages:
#   - name: Add new program

#     request:
#       url: http://{host:s}:{port:d}/api/programs
#       follow_redirects: true
#       method: POST
#       json:
#         name: "Test program"
#         description: "Test description"
#         date: "Test date"
#     response:
#       status_code: [200, 201]
#       save:
#         json:
#           program_id: id

#   - name: Modify program

#     request:
#       url: http://{host:s}:{port:d}/api/program/{program_id}/
#       follow_redirects: true
#       method: PATCH
#       json:
#         name: "Modified program name"
#       timeout: 1.0

#     response:
#       status_code: [200, 201]
#       json:
#         status: 0
#         message: "program modified"

#   - name: Retrieve the modified program

#     request:
#       url: http://{host:s}:{port:d}/api/program/{program_id}/
#       follow_redirects: true
#       method: GET
#       timeout: 1.0

#     response:
#       status_code: 200
#       json:
#         name: "Modified program name"


#   - name: Delete the program

#     request:
#       url: http://{host:s}:{port:d}/api/program/{program_id}/
#       follow_redirects: true
#       method: DELETE
#       timeout: 1.0

#     response:
#       status_code: [200, 201]
#       json:
#         status: 0
#         message: "program deleted"

# ---
# test_name: Endpoints _ 11. Delete program

# includes:
#   - !include includes.yaml

# strict:
#   - json:off

# stages:
#   - name: Add new program

#     request:
#       url: http://{host:s}:{port:d}/api/programs
#       follow_redirects: true
#       method: POST
#       json:
#         name: "Test program"
#         description: "Test description"
#         date: "Test date"


#     response:
#       status_code: [200, 201]
#       save:
#         json:
#           program_id: id

#   - name: Delete the program

#     request:
#       url: http://{host:s}:{port:d}/api/program/{program_id}/
#       follow_redirects: true
#       method: DELETE
#       timeout: 1.0

#     response:
#       status_code: [200, 201]
#       json:
#         status: 0
#         message: "program deleted"

#   - name: Retrieve the deleted program

#     request:
#       url: http://{host:s}:{port:d}/api/program/{program_id}/
#       follow_redirects: true
#       method: GET
#       timeout: 1.0

#     response:
#       status_code: [404]